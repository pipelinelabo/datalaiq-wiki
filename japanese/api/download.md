# 検索結果のダウンロード

各レンダラーは、様々なフォーマットでの検索結果のダウンロードをサポートしています。 たとえば、クエリがテーブルを介してレンダリングされる場合、結果を csv、json、またはネイティブのルックアップ形式として直接ダウンロードすることができます。 ブラウザからのダウンロード要求があった場合、ダウンロードの実行に余分な手順が必要になることがあります。 クライアントは有効なJWTでウェブサーバーに対して認証されなければならず、ユーザーはダウンロードするために検索へのアクセス権を持っていなければなりません。 ダウンロードリンクは、他のすべてのAPI URLと同様に、標準のJWTトークン・スキームを使用して保護されています。


## 検索結果をダウンロードする
ID 150460229で検索したものをCSV形式でダウンロードする。

```
GET /api/searchctrl/150460229/download/csv
```
## 一時的なJWTトークンを使ったダウンロードへアクセスする

ウェブブラウザはJavascript経由でファイルのダウンロードを実行できないため（そしてそれゆえにリクエストヘッダ経由でJWTを配信できない）、検索結果のダウンロードは「token」という名前のクッキーに格納された一時的なJWTを使用して認証することもできます。 クライアントは、通常のJWTトークンをクッキーに保存するべきではありません。その代わりに、クライアントは検索結果のダウンロードにのみ使用できる一時的なJWTを要求する必要があります。 これらの一時的なJWTトークンは、ダウンロードAPI URLへのアクセスのみを許可し、他のAPIで（ヘッダーまたはクッキーとして）使用することはできません。 一時的なJWTトークンの有効期限は3秒です。

ダウンロード・リクエストの一部として追加のヘッダーを配信できる非ブラウザベースのクライアントは、一時的なJWTトークンとクッキー・ビジネスを無視し、適切なリクエスト・ヘッダーに通常のJWTトークンを送信するだけでよいのです。 サーバーが標準ヘッダーの有効なJWTトークンを見た場合、それを認証に使用します。


### JWTの一時的なトークンを取得する

```
GET /api/login/tmptoken:
{
        "LoginStatus": true,
	"JWT": "7b22616c676f223a36323733382c22747970223a226a7774227d.7b22756964223a312c2265787069726573223a22323031382d30362d32305431333a32343a32382e393436393338312d30363a3030222c22696174223a5b3138312c36312c35382c3138352c3139322c3135392c3233302c3130372c37312c33322c3130382c33332c3134362c3138362c37392c35372c35382c33342c3135362c36342c33322c3234372c39352c35352c3138342c3235322c3135312c39382c34322c31382c35312c375d7d.cec81d84a3c96e8fd6961c1113a026eba08344d06d518e65f28bd6b92655fb6a22433fd6e42b51d62d45f8ed2a1665f3f951019b982251ebc614e8be5e4fdb6e"
}

```

ブラウザはGETリクエストの際、JWTの値を有効期限3秒の "token "という名のクッキーに格納して発行する必要があります。 このクッキーは、検索結果をダウンロードする以外のAPIでは尊重されません。
