# システム管理

このページでは、DatalaiQのプロセスや設定を管理するための管理者専用のAPIについて説明します。

## DatalaiQを再起動する

DatalaiQプロセスを再起動するために、2つのAPIが提供されています。1つはWebサーバを再起動するためのもので、もう1つはインデクサを再起動するためのものです。どちらの場合も、"再起動 "はプロセスをシャットダウンし、systemd（または使用している init システム）がそれを再起動することによって達成されます。

### ウェブサーバーを再起動する

ウェブサーバーを再起動するには、`/api/restart/webserver` に空のボディを持つ POST リクエストを送信してください。これにより、ウェブサーバーがシャットダウンし、すぐに再起動するはずです。

### インデクサを再起動する

ウェブサーバーが現在接続しているすべてのインデックスを再起動するには、 `/api/restart/indexers` に空のボディを持つ POST リクエストを送信してください。ウェブサーバーは各インデクサーに対して、自身をシャットダウンして再起動するようにシグナルを送ります。個々のインデックスが立ち上がる際に、ウェブサーバーは自動的に再接続します。

### 分散フロントエンドのデプロイ情報を確認する

DatalaiQクラスタが分散型フロントエンドモードで動作しているかどうかを確認するには、`/api/deployment`に対してGETを実行してみてください。 ウェブサーバーは、フロントエンドが分散モードで設定されているかどうかを示すJSONオブジェクトで応答します。

分散モードでない場合の応答例:

```
{
	"Distributed": false,
	"DefaultLanguage": "en_US",
}
```


### システムのバックアップを行う

管理者は、DatalaiQの状態に関連するすべてのコンテンツを含むバックアップファイルを提供するシステムのバックアップを要求することができます。

システムバックアップは、ユーザーとグループのアカウント、ダッシュボード、キット、クエリーライブラリー、さらには保存された検索を保存するために使用することができます。 これは、基本的にデータとシステム構成以外のすべてです。

バックアップは、管理者ユーザで `/api/backup` に対して `GET` リクエストを実行することで取得でき、API はバックアップファイルのダウンロードファイルを返します。

デフォルトでは、バックアップは保存された検索を含みません。バックアップに保存された検索を含めるには、GETリクエストに `savedsearch=true` URLパラメータを追加してください。

`api/backup` API は、JWT 認証トークンまたはクッキーを使って認証することができます。

備考: バックアップおよび/またはリストアは、任意の時点で1回のみ行うことができます。

### システムバックアップから復旧する

管理者ユーザは `/api/backup` API への `POST` を実行し、マルチパートフォームを使用してバックアップファイルをアップロードすることで、バックアップアーカイブからシステムを復元することができます。

APIは、バックアップファイルが`backup`フォームフィールドにあり、マルチパートフォームを使用してアップロードされることを想定しています。

`api/backup` API は、JWT 認証トークンまたはクッキーを使って認証することができます。

備考: 復元は完全な復元であり、復元ポイント以降に行われたユーザー、コンテンツ、保存された検索などの変更は失われます。

備考: バックアップおよび/またはリストアは、任意の時点で1回のみ行うことができます。

備考: 復元が開始されると、すべてのセッションが終了します。 復元が正常に終了すると、すべてのユーザーが再ログインする必要があります。
